p(){ printf %s "$1";};c(){ p "$1"|cut -c "$2";};o(){ printf "\\$(printf %03o "$1")";};P(){ qs=$(printf "%s" "$s" | sed 's/["]/\\&/g');S=$1;T=$2;i=0;j=1;l=$(p "$S"|wc -c);while [ $i -lt $l ];do i=$((i+1));x=$(c "$S" $i);if [ "$x" = '%' ];then i=$((i+1));y=$(c "$S" $i);case $y in s)p "$qs";j=$((j+1));;c)t=$(c "$T" $j);j=$((j+1));case $t in b)p '\';;q)p '"';;Q)p "'";;d)p '$';;n)o 10;;esac;;%)p '%';;esac;else p "$x";fi;done;};P "$2" "$1"
